<div class="text-center mb-4">
    <div class="mb-3">
        <i class="fas fa-key text-auth" style="font-size: 3rem;"></i>
    </div>
    <h5 class="mb-2">Forgot your password?</h5>
    <p class="text-muted">
        Enter your email address below and we'll send you a link to reset your password.
    </p>
</div>

<form id="forgotPasswordForm" action="/auth/forgot-password" method="POST" class="needs-validation" novalidate>
    {{#if csrf_token}}
    <input type="hidden" name="_token" value="{{csrf_token}}">
    {{/if}}

    <div class="form-floating">
        <input type="email"
               class="form-control {{#if errors.email}}is-invalid{{/if}}"
               id="email"
               name="email"
               placeholder="name@example.com"
               value="{{old.email}}"
               required
               autocomplete="email">
        <label for="email">
            <i class="fas fa-envelope me-2"></i>Email Address
        </label>
        {{#if errors.email}}
        <div class="invalid-feedback">{{errors.email}}</div>
        {{/if}}
    </div>

    {{#if captcha_enabled}}
    <div class="mb-3">
        <div class="g-recaptcha" data-sitekey="{{captcha_site_key}}"></div>
        {{#if errors.captcha}}
        <div class="text-danger small mt-1">{{errors.captcha}}</div>
        {{/if}}
    </div>
    {{/if}}

    <div class="d-grid mb-4">
        <button type="submit" class="btn btn-primary btn-auth btn-lg">
            <span class="loading-spinner"></span>
            <i class="fas fa-paper-plane me-2"></i>Send Reset Link
        </button>
    </div>

    <div class="text-center">
        <a href="/auth/login" class="text-auth text-decoration-none">
            <i class="fas fa-arrow-left me-2"></i>Back to Login
        </a>
    </div>
</form>

{{#if show_success}}
<div class="alert alert-success text-center" role="alert">
    <i class="fas fa-check-circle me-2"></i>
    <strong>Email Sent!</strong><br>
    If an account with that email exists, you'll receive a password reset link shortly.
</div>
{{/if}}

{{#if rate_limit_info}}
<div class="alert alert-info text-center" role="alert">
    <i class="fas fa-info-circle me-2"></i>
    You can request a new reset link in {{rate_limit_info.minutes}} minutes.
</div>
{{/if}}

<script>
document.getElementById('forgotPasswordForm').addEventListener('submit', function(e) {
    const email = document.getElementById('email').value;

    if (!email) {
        e.preventDefault();
        return;
    }

    // Show loading state
    showLoading('forgotPasswordForm');
});

// Auto-focus email field
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('email').focus();
});
</script>